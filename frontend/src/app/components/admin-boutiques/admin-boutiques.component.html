<div class="admin-boutiques-container">
  <!-- Header avec bouton retour -->
  <div class="page-header">
    <button class="back-btn" (click)="goBack()">â† Retour</button>
    <h2>ğŸ‘¨â€ğŸ’¼ Gestion des Boutiques</h2>
  </div>

  <!-- Loading -->
  <div *ngIf="isLoading" class="loading">
    <div class="spinner"></div>
    <p>Chargement des boutiques...</p>
  </div>

  <!-- Liste des boutiques -->
  <div *ngIf="!isLoading" class="boutiques-grid">
    <div *ngIf="boutiques.length === 0" class="no-boutiques">
      <h3>Aucune boutique en attente</h3>
      <p>Toutes les demandes ont Ã©tÃ© traitÃ©es.</p>
    </div>

    <div *ngFor="let boutique of boutiques" class="boutique-card">
      <div class="card-header">
        <h3>{{ boutique.nom }}</h3>
        <span class="status-badge" [style.background-color]="getStatusColor(boutique.statut)">
          {{ getStatusIcon(boutique.statut) }} {{ boutique.statut | titlecase }}
        </span>
      </div>

      <div class="card-content">
        <div class="boutique-info">
          <p><strong>ğŸ“‚ CatÃ©gorie:</strong> {{ boutique.categorie }}</p>
          <p *ngIf="boutique.description"><strong>ğŸ“ Description:</strong> {{ boutique.description }}</p>
          
          <!-- PropriÃ©taire -->
          <div class="proprietaire-info">
            <h4>ğŸ‘¤ PropriÃ©taire</h4>
            <p><strong>ğŸ“§ Email:</strong> {{ getProprietaireEmail(boutique.proprietaire) || 'Non renseignÃ©' }}</p>
            <p *ngIf="getProprietaireTelephone(boutique.proprietaire)"><strong>ğŸ“ TÃ©lÃ©phone:</strong> {{ getProprietaireTelephone(boutique.proprietaire) }}</p>
          </div>

          <!-- Emplacement -->
          <div *ngIf="boutique.emplacement" class="emplacement-info">
            <h4>ğŸ“ Emplacement</h4>
            <p *ngIf="boutique.emplacement.zone"><strong>Zone:</strong> {{ boutique.emplacement.zone }}</p>
            <p *ngIf="boutique.emplacement.numeroLocal"><strong>Local:</strong> {{ boutique.emplacement.numeroLocal }}</p>
            <p *ngIf="boutique.emplacement.etage"><strong>Ã‰tage:</strong> {{ boutique.emplacement.etage }}</p>
          </div>

          <!-- Contact -->
          <div *ngIf="boutique.contact" class="contact-info">
            <h4>ğŸ“ Contact</h4>
            <p *ngIf="boutique.contact.telephone"><strong>TÃ©lÃ©phone:</strong> {{ boutique.contact.telephone }}</p>
            <p *ngIf="boutique.contact.email"><strong>Email:</strong> {{ boutique.contact.email }}</p>
            <p *ngIf="boutique.contact.siteWeb"><strong>Site web:</strong> {{ boutique.contact.siteWeb }}</p>
          </div>
        </div>

        <div class="card-actions">
          <button class="btn-details" (click)="viewDetails(boutique)">
            ğŸ‘ï¸ Voir dÃ©tails
          </button>
          
          <div *ngIf="boutique.statut === 'en_attente'" class="action-buttons">
            <button class="btn-approve" (click)="approveBoutique(boutique._id)">
              âœ… Approuver
            </button>
            <button class="btn-reject" (click)="rejectBoutique(boutique._id)">
              âŒ Rejeter
            </button>
          </div>
        </div>
      </div>

      <div class="card-footer">
        <small>ğŸ“… CrÃ©Ã©e le {{ boutique.dateCreation | date:'dd/MM/yyyy Ã  HH:mm' }}</small>
      </div>
    </div>
  </div>

  <!-- Modal de dÃ©tails -->
  <div *ngIf="showDetails && selectedBoutique" class="modal-overlay" (click)="closeDetails()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>ğŸª {{ selectedBoutique.nom }}</h3>
        <button class="close-btn" (click)="closeDetails()">Ã—</button>
      </div>

      <div class="modal-body">
        <div class="detail-section">
          <h4>ğŸ“‹ Informations gÃ©nÃ©rales</h4>
          <p><strong>Nom:</strong> {{ selectedBoutique.nom }}</p>
          <p><strong>CatÃ©gorie:</strong> {{ selectedBoutique.categorie }}</p>
          <p><strong>Statut:</strong> 
            <span [style.color]="getStatusColor(selectedBoutique.statut)">
              {{ getStatusIcon(selectedBoutique.statut) }} {{ selectedBoutique.statut | titlecase }}
            </span>
          </p>
          <p *ngIf="selectedBoutique.description"><strong>Description:</strong> {{ selectedBoutique.description }}</p>
        </div>

        <div class="detail-section">
          <h4>ğŸ‘¤ PropriÃ©taire</h4>
          <p><strong>Nom:</strong> {{ getProprietaireNom(selectedBoutique.proprietaire) || 'Non renseignÃ©' }}</p>
          <p><strong>PrÃ©nom:</strong> {{ getProprietairePrenom(selectedBoutique.proprietaire) || 'Non renseignÃ©' }}</p>
          <p><strong>Email:</strong> {{ getProprietaireEmail(selectedBoutique.proprietaire) || 'Non renseignÃ©' }}</p>
          <p><strong>TÃ©lÃ©phone:</strong> {{ getProprietaireTelephone(selectedBoutique.proprietaire) || 'Non renseignÃ©' }}</p>
        </div>

        <div *ngIf="selectedBoutique.emplacement" class="detail-section">
          <h4>ğŸ“ Emplacement souhaitÃ©</h4>
          <p *ngIf="selectedBoutique.emplacement.zone"><strong>Zone:</strong> {{ selectedBoutique.emplacement.zone }}</p>
          <p *ngIf="selectedBoutique.emplacement.numeroLocal"><strong>NumÃ©ro de local:</strong> {{ selectedBoutique.emplacement.numeroLocal }}</p>
          <p *ngIf="selectedBoutique.emplacement.etage"><strong>Ã‰tage:</strong> {{ selectedBoutique.emplacement.etage }}</p>
        </div>

        <div *ngIf="selectedBoutique.contact" class="detail-section">
          <h4>ğŸ“ Informations de contact</h4>
          <p *ngIf="selectedBoutique.contact.telephone"><strong>TÃ©lÃ©phone:</strong> {{ selectedBoutique.contact.telephone }}</p>
          <p *ngIf="selectedBoutique.contact.email"><strong>Email:</strong> {{ selectedBoutique.contact.email }}</p>
          <p *ngIf="selectedBoutique.contact.siteWeb"><strong>Site web:</strong> {{ selectedBoutique.contact.siteWeb }}</p>
        </div>

        <div *ngIf="selectedBoutique.horaires" class="detail-section">
          <h4>ğŸ•’ Horaires d'ouverture</h4>
          <div class="horaires-grid">
            <p><strong>Lundi:</strong> {{ formatHoraire(selectedBoutique.horaires?.['lundi']) }}</p>
            <p><strong>Mardi:</strong> {{ formatHoraire(selectedBoutique.horaires?.['mardi']) }}</p>
            <p><strong>Mercredi:</strong> {{ formatHoraire(selectedBoutique.horaires?.['mercredi']) }}</p>
            <p><strong>Jeudi:</strong> {{ formatHoraire(selectedBoutique.horaires?.['jeudi']) }}</p>
            <p><strong>Vendredi:</strong> {{ formatHoraire(selectedBoutique.horaires?.['vendredi']) }}</p>
            <p><strong>Samedi:</strong> {{ formatHoraire(selectedBoutique.horaires?.['samedi']) }}</p>
            <p><strong>Dimanche:</strong> {{ formatHoraire(selectedBoutique.horaires?.['dimanche']) }}</p>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <div *ngIf="selectedBoutique.statut === 'en_attente'" class="modal-actions">
          <button class="btn-approve" (click)="approveBoutique(selectedBoutique._id); closeDetails()">
            âœ… Approuver cette boutique
          </button>
          <button class="btn-reject" (click)="rejectBoutique(selectedBoutique._id); closeDetails()">
            âŒ Rejeter cette boutique
          </button>
        </div>
        <button class="btn-secondary" (click)="closeDetails()">Fermer</button>
      </div>
    </div>
  </div>
</div>